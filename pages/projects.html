<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Projects - Subhadra Bro</title>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="icon" href="../img/icon/favicon.ico" type="image/x-icon">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'dark-base': '#1e293b',
                        'dark-secondary': '#334155',
                        'vibrant-teal': '#2dd4bf',
                        'vibrant-blue': '#6366f1',
                        'light-text': '#fafafa',
                        'neutral-gray': '#9ca3af',
                    },
                },
            },
        }
    </script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
        integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
        <script src="../js/pageView.js" ></script>
</head>

<body class="bg-dark-secondary font-sans">

    <!-- Navigation Bar (same as index.html) -->
    <nav class="bg-dark-base p-4">
        <div class="container mx-auto flex justify-between items-center">
            <a href="../" class="text-light-text text-xl font-bold">Subhadra Bro</a>
            <div class="hidden md:flex space-x-6">
                <a href="../" class="text-neutral-gray hover:text-vibrant-teal">Home</a>
                <a href="./projects.html" class="text-light-text hover:text-vibrant-teal">Projects</a>
                <a href="./services.html" class="text-neutral-gray hover:text-vibrant-teal">Services</a>
                <a href="./terms.html" class="text-neutral-gray hover:text-vibrant-teal">Terms & Conditions</a>
                <a href="./contact.html" class="text-neutral-gray hover:text-vibrant-teal">Contact</a>
            </div>
            <div class="md:hidden">
                <button id="mobile-menu-button" class="text-light-text focus:outline-none">
                    <svg class="h-6 w-6 fill-current" viewBox="0 0 24 24">
                        <path v-if="!isOpen" fill-rule="evenodd" clip-rule="evenodd"
                            d="M4 5h16a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V6a1 1 0 011-1zm0 7h16a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1v-2a1 1 0 011-1zm0 7h16a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1v-2a1 1 0 011-1z" />
                        <path v-if="isOpen" fill-rule="evenodd" clip-rule="evenodd"
                            d="M4 5h16a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V6a1 1 0 011-1zm0 7h16a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1v-2a1 1 0 011-1zm0 7h16a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1v-2a1 1 0 011-1z" />
                    </svg>
                </button>
            </div>
        </div>
        <!-- Mobile Menu -->
        <div class="md:hidden hidden" id="mobile-menu">
            <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3 bg-dark-secondary rounded-lg mt-5">
                <a href="../"
                    class="block text-neutral-gray hover:bg-dark-base hover:text-vibrant-teal px-3 py-2 rounded-md text-base font-medium">Home</a>
                <a href="./projects.html"
                    class="block bg-dark-secondary text-light-text px-3 py-2 rounded-md text-base font-medium">Projects</a>
                <a href="./services.html"
                    class="block text-neutral-gray hover:bg-dark-base hover:text-vibrant-teal px-3 py-2 rounded-md text-base font-medium">Services</a>
                <a href="./terms.html"
                    class="block text-neutral-gray hover:bg-dark-base hover:text-vibrant-teal px-3 py-2 rounded-md text-base font-medium">Terms
                    & Conditions</a>
                <a href="./contact.html"
                    class="block text-neutral-gray hover:bg-dark-base hover:text-vibrant-teal px-3 py-2 rounded-md text-base font-medium">Contact</a>
            </div>
        </div>
    </nav>

    <!-- Projects Section -->
    <section class="py-16 bg-dark-secondary min-h-[80vh]">
        <div class="container mx-auto">
            <h2 class="text-3xl font-bold text-center mb-12 text-light-text">My Projects</h2>
            <div class=" flex flex-wrap justify-start" id="projects-container">
                <!-- Project cards will be inserted here by JavaScript -->
                <div class="text-center text-neutral-gray" id="loading-message">Loading projects from GitHub...</div>
            </div>
        </div>
    </section>

    <!-- Footer (same as index.html) -->
    <footer class="bg-dark-base text-light-text py-8">
        <div class="container mx-auto text-center">
            <p>Â© 2023-2025 Subhadra Bro. All rights reserved.</p>
            <div class="mt-4">
                <a href="https://www.youtube.com/channel/UCeDeaDD8dpdMT2gO3VHY1JQ" target="_blank"
                    class="text-neutral-gray hover:text-vibrant-teal mx-2"><i class="fab fa-youtube text-xl"></i></a>
                <a href="https://t.me/Subadra_Poshitha" target="_blank"
                    class="text-neutral-gray hover:text-vibrant-teal mx-2"><i class="fab fa-telegram text-xl"></i></a>
                <a href="mailto:subadraposhithapr@gmail.com" class="text-neutral-gray hover:text-vibrant-teal mx-2"><i
                        class="fas fa-envelope text-xl"></i></a>
                <a href="https://github.com/AiDarkEzio" target="_blank" class="text-neutral-gray hover:text-vibrant-teal mx-2"><i class="fab fa-github text-xl"></i></a>
            </div>
        </div>
    </footer>

    <script>
        const mobileMenuButtonProjects = document.getElementById('mobile-menu-button');
        const mobileMenuProjects = document.getElementById('mobile-menu');

        mobileMenuButtonProjects.addEventListener('click', () => {
            mobileMenuProjects.classList.toggle('hidden');
        });
    </script>

    <script>
        // GitHub username (replace with your actual username)
        const githubUsername = 'aidarkezio'; // *** IMPORTANT: REPLACE THIS! ***
        const maxColumns = 3; // Maximum columns for larger screens (let's aim for 3 max)

        const projectsContainer = document.getElementById('projects-container');
        const loadingMessage = document.getElementById('loading-message');

        async function fetchGitHubProjects() {
            let allProjects = []; // Array to store all projects
            let nextPageUrl = `https://api.github.com/users/${githubUsername}/repos?sort=updated&direction=desc&type=all&per_page=100`; // Start with the first page, request up to 100 per page

            loadingMessage.textContent = 'Loading projects from GitHub...'; // Ensure loading message is set

            try {
                while (nextPageUrl) {
                    const response = await fetch(nextPageUrl);

                    if (!response.ok) {
                        throw new Error(`GitHub API error! Status: ${response.status}`);
                    }

                    const projects = await response.json();
                    allProjects = allProjects.concat(projects); // Add projects from current page to all projects

                    // Pagination handling - check for 'Link' header
                    const linkHeader = response.headers.get('Link');
                    nextPageUrl = null; // Reset for next iteration
                    if (linkHeader) {
                        const links = linkHeader.split(',');
                        for (const link of links) {
                            if (link.includes('rel="next"')) {
                                const urlMatch = link.match(/<([^>]+)>/);
                                if (urlMatch) {
                                    nextPageUrl = urlMatch[1]; // Extract the URL for the next page
                                    break; // Found the 'next' link, move to the next iteration
                                }
                            }
                        }
                    }

                    // Optional: Add a small delay to be nice to the API and avoid rate limiting if fetching many pages rapidly
                    // await new Promise(resolve => setTimeout(resolve, 500)); // 0.5 second delay
                }

                loadingMessage.style.display = 'none'; // Hide loading message after all pages are fetched

                if (allProjects.length === 0) {
                    projectsContainer.innerHTML = '<p class="text-neutral-gray text-center">No public projects found on GitHub.</p>';
                    return;
                }

                projectsContainer.innerHTML = ''; // Clear "Loading..." message and any previous content

                // Create column wrappers - create a max number of columns upfront
                const columns = [];
                for (let i = 0; i < maxColumns; i++) {
                    const column = document.createElement('div');
                    // Simplified responsive column widths:
                    column.className = `flex-1 px-2 sm:w-full md:w-1/2 lg:w-1/3`; // 1 col < sm, 2 cols >= md, 3 cols >= lg
                    columns.push(column);
                    projectsContainer.appendChild(column);
                }


                allProjects.forEach((project, index) => {
                    // No longer skipping forks: // if (project.fork) return;

                    const projectCard = document.createElement('div');
                    projectCard.className = 'bg-dark-base rounded-lg shadow-md hover:shadow-lg overflow-hidden m-4';

                    const projectContent = document.createElement('div');
                    projectContent.className = 'p-6';

                    const projectTitle = document.createElement('h3');
                    projectTitle.className = 'font-bold text-xl mb-2 text-light-text';
                    projectTitle.textContent = project.name;

                    const projectDescription = document.createElement('p');
                    projectDescription.className = 'text-neutral-gray mb-4';
                    projectDescription.textContent = project.description || 'No description provided.'; // Use description from GitHub, or default message

                    const viewProjectLink = document.createElement('a');
                    viewProjectLink.href = project.html_url;
                    viewProjectLink.target = '_blank'; // Open in new tab
                    viewProjectLink.className = 'inline-block bg-vibrant-blue text-dark-base py-2 px-4 rounded-full hover:bg-vibrant-teal transition-colors duration-300';
                    viewProjectLink.textContent = 'View Project on GitHub';

                    projectContent.appendChild(projectTitle);
                    projectContent.appendChild(projectDescription);
                    projectContent.appendChild(viewProjectLink);

                    projectCard.appendChild(projectContent);

                    // Append the card to the appropriate column using modulo operator for even distribution
                    columns[index % maxColumns].appendChild(projectCard);
                });

            } catch (error) {
                loadingMessage.style.display = 'none'; // Hide loading message in case of error
                // Improved error message with GitHub profile link
                projectsContainer.className = "text-center text-neutral-gray text-lg p-8";
                projectsContainer.innerHTML = `
                    <p class="text-red-500 mb-3">Error loading projects from GitHub.</p>
                    <p>You can also view my projects directly on <a class="font-bold text-vibrant-teal hover:underline" href="https://github.com/${githubUsername}" target="_blank" class="text-vibrant-blue hover:text-vibrant-teal underline">GitHub</a>.</p>
            `;
                console.error('Error fetching GitHub projects:', error);
            }
        }


        fetchGitHubProjects(); // Call the function to fetch and display projects when the page loads
    </script>
</body>

</html>
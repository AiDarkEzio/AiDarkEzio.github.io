<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Submit Contribution Task - Subhadra Bro</title>
    <link rel="stylesheet" href="../../css/style.css">
    <link rel="icon" href="../../img/icon/favicon.ico" type="image/x-icon">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'black-base': '#0d1117', // Very dark, GitHub-like dark base
                        'dark-card': 'rgba(30, 41, 59, 0.6)', // Semi-transparent dark for cards
                        'dark-nav': 'rgba(13, 17, 23, 0.8)', // Darker, more opaque for nav/footer bg
                        'border-glass': 'rgba(255, 255, 255, 0.1)', // Subtle border for glassy elements
                        'vibrant-teal': '#2dd4bf',
                        'vibrant-blue': '#6366f1',
                        'light-text': '#e6edf3', // Slightly off-white for better readability
                        'medium-text': '#bdc1c6', // For secondary text
                        'neutral-gray': '#7d8590', // For less important text/icons
                        'transparent-red-subtle': 'rgba(222, 77, 85, 0.1)', // Adjusted red tint
                        'transparent-red-hint': 'rgba(222, 77, 85, 0.2)',   // Adjusted red tint
                        'transparent-green-hint': 'rgba(63, 185, 80, 0.15)', // Adjusted green tint
                    },
                    fontFamily: {
                        // Use Poppins as default sans-serif, Nunito as secondary option if needed
                        sans: ['Poppins', 'sans-serif'],
                        serif: ['Roboto Serif', 'serif'],
                        mono: ['Inconsolata', 'monospace'],
                    },
                    backdropBlur: {
                        xs: '2px',
                        sm: '4px',
                        md: '8px',
                        lg: '12px',
                        xl: '16px',
                    },
                    boxShadow: {
                        'glass': '0 4px 30px rgba(0, 0, 0, 0.1)', // Subtle shadow for glass effect
                         'glow-teal': '0 0 15px 2px rgba(45, 212, 191, 0.4)', // Subtle glow effect
                         'glow-blue': '0 0 15px 2px rgba(99, 102, 241, 0.4)', // Subtle glow effect
                    }
                },
            },
        }
    </script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
        integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!-- Toastr CSS -->
    <link rel="stylesheet" href="../../css/toastr.min.css">
    <!-- Include jQuery FIRST -->
    <script src="../../js/jquery.min.js"></script>
    <!-- Then Toastr JS -->
    <script src="../../js/toastr.min.js"></script>
    <!-- Your page view script -->
    <script src="../../js/pageView.js" defer></script>
</head>

<body class="bg-black-base text-light-text font-sans">
    <!-- Navigation Bar -->
    <nav class="fixed top-0 left-0 right-0 z-50 bg-dark-nav backdrop-blur-lg border-b border-border-glass shadow-md transition-all duration-300 ease-in-out">
        <div class="container mx-auto flex justify-between items-center px-4 py-3">
            <a href="../../" class="text-light-text text-xl font-bold hover:text-vibrant-teal">Subhadra Bro</a>
            <div class="hidden md:flex space-x-6 items-center">
                <a href="../../" class="text-medium-text hover:text-vibrant-teal pb-1 hover-effect">Home</a>
                <a href="../projects.html" class="text-medium-text hover:text-vibrant-teal pb-1 hover-effect">Projects</a>
                <a href="../services.html" class="text-vibrant-teal border-b-2 border-vibrant-teal pb-1 font-medium hover-effect">Services</a>
                <a href="../terms.html" class="text-medium-text hover:text-vibrant-teal pb-1 hover-effect">Terms</a>
                <a href="../contact.html" class="text-medium-text hover:text-vibrant-teal pb-1 hover-effect">Contact</a>
            </div>
             <div class="md:hidden">
                 <button id="mobile-menu-button" class="text-light-text focus:outline-none p-1 hover:text-vibrant-teal">
                    <i class="fas fa-bars text-xl"></i>
                </button>
            </div>
        </div>
        <!-- Mobile Menu -->
         <div class="md:hidden hidden absolute top-full left-0 right-0 bg-dark-nav backdrop-blur-lg border-b border-border-glass shadow-lg" id="mobile-menu">
             <div class="px-4 pt-2 pb-3 space-y-1">
                <a href="../../" class="block text-medium-text hover:bg-black-base/30 hover:text-vibrant-teal px-3 py-2 rounded-md text-base font-medium">Home</a>
                <a href="../projects.html" class="block text-medium-text hover:bg-black-base/30 hover:text-vibrant-teal px-3 py-2 rounded-md text-base font-medium">Projects</a>
                <a href="../services.html" class="block text-vibrant-teal bg-black-base/30 px-3 py-2 rounded-md text-base font-medium">Services</a>
                <a href="../terms.html" class="block text-medium-text hover:bg-black-base/30 hover:text-vibrant-teal px-3 py-2 rounded-md text-base font-medium">Terms</a>
                <a href="../contact.html" class="block text-medium-text hover:bg-black-base/30 hover:text-vibrant-teal px-3 py-2 rounded-md text-base font-medium">Contact</a>
            </div>
        </div>
    </nav>

    <!-- Spacer for fixed navbar -->
    <div class="pt-16"></div>

    <!-- Task Submission Section -->
    <section class="py-16 md:py-24 bg-gradient-to-br from-black-base via-slate-900 to-black-base">
        <div class="container mx-auto px-4">
            <h2 class="text-3xl md:text-4xl font-bold text-center mb-6 text-light-text">Submit a Contribution Task</h2>
            <p class="text-center text-medium-text mb-10 max-w-3xl mx-auto">
                Have an open-source task you think I could help with? Fill out the form below. Contributions are offered for learning on a best-effort basis. Please review the <a href="../terms.html#oss-terms" class="text-vibrant-teal hover:underline">contribution terms</a>.
            </p>

            <!-- Task Submission Form -->
            <form id="task-form" class="glass-card max-w-4xl mx-auto p-6 md:p-10 hover-effect" novalidate>

                <fieldset class="mb-8">
                    <legend class="text-xl font-semibold mb-4 text-vibrant-teal border-b border-border-glass pb-2 w-full">Requester Information</legend>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                        <div>
                            <label class="block text-light-text text-sm font-bold mb-2" for="requester_name">
                                Your Name/Alias <span class="text-red-400">*</span>
                            </label>
                            <input class="glass-input" id="requester_name" name="requester_name" type="text" placeholder="e.g., Jane Doe or ProjectAlias" required>
                        </div>
                        <div>
                            <label class="block text-light-text text-sm font-bold mb-2" for="requester_email">
                                Your Email <span class="text-red-400">*</span>
                            </label>
                            <input class="glass-input" id="requester_email" name="requester_email" type="email" placeholder="your.email@example.com" required>
                        </div>
                        <div class="md:col-span-2">
                            <label class="block text-light-text text-sm font-bold mb-2" for="requester_role">
                                Your Role (Optional)
                            </label>
                            <input class="glass-input" id="requester_role" name="requester_role" type="text" placeholder="e.g., Project Maintainer, Contributor">
                        </div>
                    </div>
                </fieldset>

                <!-- Project Information -->
                 <fieldset class="mb-8">
                    <legend class="text-xl font-semibold mb-4 text-vibrant-teal border-b border-border-glass pb-2 w-full">Project Information</legend>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                         <div class="md:col-span-2">
                            <label class="block text-light-text text-sm font-bold mb-2" for="project_name">
                                Project Name <span class="text-red-400">*</span>
                            </label>
                            <input class="glass-input" id="project_name" name="project_name" type="text" placeholder="Name of the open-source project" required>
                        </div>
                         <div class="md:col-span-2">
                            <label class="block text-light-text text-sm font-bold mb-2" for="project_url">
                                Project URL (Repository) <span class="text-red-400">*</span>
                            </label>
                            <input class="glass-input" id="project_url" name="project_url" type="url" placeholder="https://github.com/user/repo" required>
                        </div>
                         <div class="md:col-span-2">
                            <label class="block text-light-text text-sm font-bold mb-2" for="project_description">
                                Project Description (Optional but Recommended)
                            </label>
                            <textarea class="glass-textarea" id="project_description" name="project_description" rows="3" placeholder="Briefly describe what the project does."></textarea>
                        </div>
                    </div>
                 </fieldset>

                <!-- Task Information -->
                 <fieldset class="mb-8">
                    <legend class="text-xl font-semibold mb-4 text-vibrant-teal border-b border-border-glass pb-2 w-full">Task Information</legend>
                     <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                         <div class="md:col-span-2">
                            <label class="block text-light-text text-sm font-bold mb-2" for="task_title">
                                Task Title / Issue Summary <span class="text-red-400">*</span>
                            </label>
                            <input class="glass-input" id="task_title" name="task_title" type="text" placeholder="Short, descriptive title (e.g., Fix typo in README)" required>
                        </div>
                         <div class="md:col-span-2">
                            <label class="block text-light-text text-sm font-bold mb-2" for="task_description">
                                Task Description <span class="text-red-400">*</span>
                            </label>
                            <textarea class="glass-textarea" id="task_description" name="task_description" rows="5" placeholder="Detailed description: What needs doing? Expected outcome? Steps to reproduce (if bug)?" required></textarea>
                        </div>
                        <div class="md:col-span-2">
                            <label class="block text-light-text text-sm font-bold mb-2" for="task_issue_url">
                                Task Issue URL (Optional, Recommended)
                            </label>
                            <input class="glass-input" id="task_issue_url" name="task_issue_url" type="url" placeholder="Link to GitHub/GitLab issue, if any">
                        </div>
                        <div class="md:col-span-2">
                            <label class="block text-light-text text-sm font-bold mb-2" for="task_relevant_skills">
                                Relevant Skills Needed <span class="text-red-400">*</span>
                            </label>
                            <textarea class="glass-textarea" id="task_relevant_skills" name="task_relevant_skills" rows="2" placeholder="e.g., Python, Django, JavaScript, CSS, Docker" required></textarea>
                        </div>
                        <div>
                            <label class="block text-light-text text-sm font-bold mb-2" for="task_difficulty">
                                Task Difficulty (Optional)
                            </label>
                            <select class="glass-select" id="task_difficulty" name="task_difficulty">
                                <option value="">Select Difficulty</option>
                                <option value="Beginner-Friendly">Beginner-Friendly / Good First Issue</option>
                                <option value="Intermediate">Intermediate</option>
                                <option value="Guidance Needed">Requires Some Guidance</option>
                                <option value="Challenging">Challenging</option>
                            </select>
                        </div>
                         <div>
                            <label class="block text-light-text text-sm font-bold mb-2" for="task_estimated_effort">
                                Estimated Effort (Optional)
                            </label>
                            <input class="glass-input" id="task_estimated_effort" name="task_estimated_effort" type="text" placeholder="e.g., A few hours, 1-2 days">
                        </div>
                    </div>
                 </fieldset>

                 <!-- Communication & Expectations -->
                 <fieldset class="mb-6">
                    <legend class="text-xl font-semibold mb-4 text-vibrant-teal border-b border-border-glass pb-2 w-full">Communication & Expectations</legend>
                     <div class="grid grid-cols-1 gap-y-4">
                         <div>
                            <label class="block text-light-text text-sm font-bold mb-2" for="communication_preference">
                                Preferred Communication (Optional)
                            </label>
                            <input class="glass-input" id="communication_preference" name="communication_preference" type="text" placeholder="e.g., GitHub Issues, Email, Project's Discord/Slack">
                        </div>
                        <div>
                             <label class="flex items-center text-light-text text-sm font-medium mt-2 cursor-pointer">
                                <input class="form-checkbox h-5 w-5 text-vibrant-blue bg-slate-700 border-border-glass rounded focus:ring-vibrant-teal mr-3"
                                       type="checkbox" id="agreement_checkbox" name="agreement_checkbox" required>
                                <span class="select-none">
                                    I have read and understand the <a class="font-bold text-vibrant-teal hover:underline" target="_blank" rel="noopener noreferrer" href="../terms.html#oss-terms">Terms & Conditions</a> for this free, best-effort contribution service. <span class="text-red-400">*</span>
                                </span>
                            </label>
                        </div>
                     </div>
                 </fieldset>

                <!-- Submit Button -->
                <div class="flex items-center justify-center mt-10">
                    <button
                        class="bg-vibrant-blue hover:bg-vibrant-teal text-light-text hover:text-black-base font-bold py-3 px-8 rounded-lg focus:outline-none focus:shadow-outline focus:ring-2 focus:ring-vibrant-blue/50 transform hover:scale-105 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed"
                        type="submit" id="submit-task-button">
                        Submit Task Request
                    </button>
                </div>
            </form>

        </div>
    </section>

    <!-- Footer -->
     <footer class="bg-dark-nav text-medium-text py-8 border-t border-border-glass">
         <div class="container mx-auto text-center px-4">
             <p>Â© 2023-2025 Subhadra Bro. All rights reserved.</p>
             <div class="mt-4 flex justify-center space-x-5">
                 <a href="https://www.youtube.com/channel/UCeDeaDD8dpdMT2gO3VHY1JQ" target="_blank" rel="noopener noreferrer"
                     class="text-neutral-gray hover:text-vibrant-teal transition duration-300 transform hover:scale-110"><i class="fab fa-youtube text-xl"></i></a>
                 <a href="https://t.me/Subadra_Poshitha" target="_blank" rel="noopener noreferrer"
                     class="text-neutral-gray hover:text-vibrant-teal transition duration-300 transform hover:scale-110"><i class="fab fa-telegram text-xl"></i></a>
                 <a href="mailto:subadraposhithapr@gmail.com"
                     class="text-neutral-gray hover:text-vibrant-teal transition duration-300 transform hover:scale-110"><i class="fas fa-envelope text-xl"></i></a>
                 <a href="https://github.com/AiDarkEzio" target="_blank" rel="noopener noreferrer"
                     class="text-neutral-gray hover:text-vibrant-teal transition duration-300 transform hover:scale-110"><i class="fab fa-github text-xl"></i></a>
             </div>
         </div>
     </footer>

    <script>
        // Mobile Menu Toggle Script (Use the improved version from index.html)
        const mobileMenuButtonContribContact = document.getElementById('mobile-menu-button');
        const mobileMenuContribContact = document.getElementById('mobile-menu');
        const menuIconContribContact = mobileMenuButtonContribContact.querySelector('i');

        mobileMenuButtonContribContact.addEventListener('click', (event) => {
            event.stopPropagation();
            mobileMenuContribContact.classList.toggle('hidden');
             if (mobileMenuContribContact.classList.contains('hidden')) {
                 menuIconContribContact.classList.remove('fa-times'); menuIconContribContact.classList.add('fa-bars');
             } else {
                 menuIconContribContact.classList.remove('fa-bars'); menuIconContribContact.classList.add('fa-times');
             }
        });
         document.addEventListener('click', function(event) {
           const isClickInsideNav = mobileMenuButtonContribContact.contains(event.target) || mobileMenuContribContact.contains(event.target);
           if (!isClickInsideNav && !mobileMenuContribContact.classList.contains('hidden')) {
             mobileMenuContribContact.classList.add('hidden');
             menuIconContribContact.classList.remove('fa-times'); menuIconContribContact.classList.add('fa-bars');
           }
         });

        // --- Task Form Submission Script (Updated for new styles/layout) ---
        document.addEventListener('DOMContentLoaded', function () {
            const taskForm = document.getElementById('task-form');
            const submitButton = document.getElementById('submit-task-button');
            const originalButtonText = submitButton.textContent;
            const apiEndpoint = 'https://aidarkezio.vercel.app/api/contact-me';

            // Toastr options
            toastr.options = {
              "closeButton": true,
              "progressBar": true,
              "positionClass": "toast-top-right",
              "preventDuplicates": true,
              "timeOut": "6000", // Slightly longer timeout
              "showEasing": "swing",
              "hideEasing": "linear",
              "showMethod": "fadeIn",
              "hideMethod": "fadeOut"
            };

            taskForm.addEventListener('submit', function (event) {
                event.preventDefault(); // Prevent default form submission

                submitButton.disabled = true;
                submitButton.innerHTML = `<i class="fas fa-spinner fa-spin mr-2"></i>Submitting...`; // Adding spinner

                // Get Form Values by ID
                const formData = {
                    requester_name: document.getElementById('requester_name').value.trim(),
                    requester_email: document.getElementById('requester_email').value.trim(),
                    requester_role: document.getElementById('requester_role').value.trim(),
                    project_name: document.getElementById('project_name').value.trim(),
                    project_url: document.getElementById('project_url').value.trim(),
                    project_description: document.getElementById('project_description').value.trim(),
                    task_title: document.getElementById('task_title').value.trim(),
                    task_description: document.getElementById('task_description').value.trim(),
                    task_issue_url: document.getElementById('task_issue_url').value.trim(),
                    task_relevant_skills: document.getElementById('task_relevant_skills').value.trim(),
                    task_difficulty: document.getElementById('task_difficulty').value,
                    task_estimated_effort: document.getElementById('task_estimated_effort').value.trim(),
                    communication_preference: document.getElementById('communication_preference').value.trim(),
                    agreement_checkbox: document.getElementById('agreement_checkbox').checked
                };

                // --- Client-Side Validation ---
                let isValid = true;
                let firstErrorFieldId = null;

                function markInvalid(fieldId, message) {
                    toastr.error(message);
                    const field = document.getElementById(fieldId);
                    if (field) {
                        field.classList.add('border-red-500', 'ring-red-500'); // Example validation style
                        if (!firstErrorFieldId) {
                             firstErrorFieldId = fieldId; // Track first error for focus
                        }
                    }
                    isValid = false;
                }
                function clearValidation(fieldId) {
                     const field = document.getElementById(fieldId);
                     if (field) {
                        field.classList.remove('border-red-500', 'ring-red-500');
                    }
                }

                 // Clear previous validation styles
                Array.from(taskForm.elements).forEach(el => clearValidation(el.id));


                if (!formData.requester_name) markInvalid('requester_name', 'Please enter your name or alias.');
                if (!formData.requester_email) {
                    markInvalid('requester_email', 'Please enter your email address.');
                } else if (!/^\S+@\S+\.\S+$/.test(formData.requester_email)) {
                    markInvalid('requester_email', 'Please enter a valid email address.');
                }
                if (!formData.project_name) markInvalid('project_name', 'Please enter the project name.');
                if (!formData.project_url) {
                     markInvalid('project_url', 'Please enter the project repository URL.');
                } else {
                     try {
                         const url = new URL(formData.project_url);
                         // Basic check if it looks like a common repo host (optional but helpful)
                         if (!['github.com', 'gitlab.com', 'bitbucket.org'].some(host => url.hostname.includes(host))) {
                            toastr.warning('Please ensure the Project URL is a valid repository link (e.g., GitHub, GitLab).');
                            // Consider not marking as invalid, just warning
                         }
                     } catch (_) {
                          markInvalid('project_url', 'Please enter a valid URL (e.g., https://...).');
                     }
                 }
                if (!formData.task_title) markInvalid('task_title', 'Please enter a task title or summary.');
                if (!formData.task_description) markInvalid('task_description', 'Please provide a description of the task.');
                if (!formData.task_relevant_skills) markInvalid('task_relevant_skills', 'Please list the relevant skills needed.');
                if (!formData.agreement_checkbox) markInvalid('agreement_checkbox', 'You must agree to the terms to submit.');

                // If validation fails
                if (!isValid) {
                    submitButton.textContent = originalButtonText;
                    submitButton.disabled = false;
                    if (firstErrorFieldId) {
                        document.getElementById(firstErrorFieldId)?.focus(); // Focus the first field with an error
                    }
                    return; // Stop submission
                }

                // --- Construct Message for Backend ---
                // (Sending structured data might be better, but adapting current backend)
                const messageBody = `
**Contribution Task Request**
------------------------------
**Requester:** ${formData.requester_name} (${formData.requester_email})
**Role:** ${formData.requester_role || 'N/A'}
------------------------------
**Project:** ${formData.project_name}
**Repo URL:** ${formData.project_url}
**Project Desc:** ${formData.project_description || 'N/A'}
------------------------------
**Task Title:** ${formData.task_title}
**Task Desc:** ${formData.task_description}
**Issue URL:** ${formData.task_issue_url || 'N/A'}
**Skills Needed:** ${formData.task_relevant_skills}
**Difficulty:** ${formData.task_difficulty || 'N/A'}
**Est. Effort:** ${formData.task_estimated_effort || 'N/A'}
------------------------------
**Comm Preference:** ${formData.communication_preference || 'N/A'}
**Agreement:** ${formData.agreement_checkbox ? 'Accepted' : 'NOT Accepted'}
                `;


                // --- API Call (fetch) ---
                fetch(apiEndpoint, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Accept': 'application/json'
                    },
                     // Sending structured data would be ideal, but matching current API:
                     body: JSON.stringify({
                         name: `[Task Request] ${formData.project_name} - ${formData.requester_name}`, // Modified name for backend filtering
                         email: formData.requester_email,
                         message: messageBody // Send the structured message
                     })
                })
                .then(response => {
                    if (!response.ok) {
                        return response.json().catch(() => {
                           throw new Error(`HTTP error! Status: ${response.status}`);
                        }).then(errData => {
                           throw new Error(errData.message || `HTTP error! Status: ${response.status}`);
                        });
                    }
                    return response.json();
                })
                .then(data => {
                    console.log('Success:', data);
                    toastr.success(data.message || 'Task request submitted successfully!');
                    taskForm.reset();
                     Array.from(taskForm.elements).forEach(el => clearValidation(el.id)); // Clear validation styles on success
                    submitButton.textContent = originalButtonText;
                    submitButton.disabled = false;
                })
                .catch((error) => {
                    console.error('Error:', error);
                    toastr.error('Error submitting task: ' + error.message);
                    submitButton.textContent = originalButtonText;
                    submitButton.disabled = false;
                });
            });
        });
    </script>
</body>
</html>